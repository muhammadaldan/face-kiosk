(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(t,e){},164:function(t,e){},166:function(t,e){},189:function(t,e){},190:function(t,e){},192:function(t,e){},194:function(t,e){},202:function(t,e){},204:function(t,e){},207:function(t,e,n){},208:function(t,e,n){"use strict";n.r(e);var i=n(5),o=n.n(i),c=n(80),r=n.n(c),a=n(26),u=n(82),s=function(t){var e=Object(i.useState)(),n=Object(a.a)(e,2),o=n[0],c=n[1];return Object(i.useEffect)(function(){u.a.load(t).then(function(t){c(t)})},[t]),o},l=n(8),f=n.n(l),d=n(41),h=n(15),b=function(t,e){Object(i.useEffect)(function(){navigator.mediaDevices&&navigator.mediaDevices.getUserMedia&&navigator.mediaDevices.getUserMedia({audio:!1,video:{facingMode:"user",width:{ideal:4096},height:{ideal:2160}}}).then(function(n){t.current.srcObject=n,t.current.onloadedmetadata=function(){e()}})},[e,t])},x=function(t){var e=t.getContext("2d"),n=window.devicePixelRatio,i=t.width/n,o=t.height/n;return{setWidth:function(e){i=e,t.style.width=e+"px",t.width=e*n},setHeight:function(e){o=e,t.style.height=e+"px",t.height=e*n},width:i,height:o,clearAll:function(){return e.clearRect(0,0,i*n,o*n)},clearRect:function(t,i,o,c){return e.clearRect(t*n,i*n,o*n,c*n)},setFont:function(t){var i=parseInt(t,10)*n,o=t.replace(/^\d+px/,i+"px");e.font=o},setTextBaseLine:function(t){e.textBaseline=t},setStrokeStyle:function(t){e.strokeStyle=t},setLineWidth:function(t){e.lineWidth=t*n},strokeRect:function(t,i,o,c){return e.strokeRect(t*n,i*n,o*n,c*n)},setFillStyle:function(t){e.fillStyle=t},measureText:function(t){var i=e.measureText(t);return{width:i.width/n,actualBoundingBoxLeft:i.actualBoundingBoxLeft/n,actualBoundingBoxRight:i.actualBoundingBoxRight/n,actualBoundingBoxAscent:i.actualBoundingBoxAscent/n,actualBoundingBoxDescent:i.actualBoundingBoxDescent/n}},fillRect:function(t,i,o,c){return e.fillRect(t*n,i*n,o*n,c*n)},fillText:function(t,i,o){return e.fillText(t,i*n,o*n)}}},m=n(81),v=n(97).connect("mqtt://127.0.0.1:1884"),g=function(t){var e=(100*t.score).toFixed(1);return"".concat(t.label," ").concat(e,"%")};v.on("connect",function(){v.subscribe("mask")});var p="false";v.on("message",function(t,e){Object(m.a)("send"),p=e.toString()});var y=function(t,e){var n="".concat(16,"px 'ibm-plex-sans', Helvetica Neue, Arial, sans-serif");t.setFont(n),t.setTextBaseLine("top");var i=parseInt(n,10);e.forEach(function(e){var n=e.bbox[0],o=e.bbox[1],c=e.bbox[2],r=e.bbox[3],a=g(e),u="M"==a[0]?"true,#":"false,#";"true"===p&&(v.publish("data",u),v.publish("mask","stop")),a.includes("No")?(t.setStrokeStyle("#FF0000"),t.setLineWidth(4)):(t.setStrokeStyle("#00FF00"),t.setLineWidth(4)),t.strokeRect(Math.round(n),Math.round(o),Math.round(c),Math.round(r)),a.includes("No")?t.setFillStyle("#FF0000"):t.setFillStyle("#00FF00");var s=t.measureText(a).width;t.fillRect(Math.round(n-2),Math.round(o-(i+8)-6),Math.round(s+16),Math.round(i+8))}),e.forEach(function(e){var n=e.bbox[0],o=e.bbox[1],c=g(e);t.setFillStyle("#ffffff"),t.fillText(c,Math.round(n-2+8),Math.round(o-(i+8)-6+4))})},w=o.a.memo(function(t){var e=t.model,n=t.onPrediction,c=t.fit,r=t.mirrored,a=t.render,u=Object(i.useRef)(),s=Object(i.useRef)();b(u,function(){l()});var l=Object(i.useCallback)(Object(h.a)(f.a.mark(function t(){var i,o,h,b,m,v,g,p,w,B,F,M;return f.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,e.detect(u.current);case 2:i=t.sent,n&&n(i),o=u.current.offsetWidth,h=u.current.offsetHeight,b=u.current.videoWidth,m=u.current.videoHeight,v=o/b,g=h/m,p="aspectFit"===c?Math.min(v,g):Math.max(v,g),w=(o-b*p)/2,B=(h-m*p)/2,(F=x(s.current)).setWidth(o),F.setHeight(h),F.clearAll(),M=i.map(function(t){var e=t.bbox[0]*p+w,n=t.bbox[1]*p+B,i=t.bbox[2]*p,c=t.bbox[3]*p;return r&&(e=o-e-i),Object(d.a)(Object(d.a)({},t),{},{bbox:[e,n,i,c]})}),(a||y)(F,M),requestAnimationFrame(function(){l()});case 21:case"end":return t.stop()}},t)})),[c,r,e,n,a]);return s.current&&(s.current.style.position="absolute",s.current.style.left="0",s.current.style.top="0"),u.current&&(u.current.style.width="100%",u.current.style.height="100%",u.current.style.objectFit="aspectFit"===c?"contain":"cover",u.current.style.transform=r?"scaleX(-1)":"scaleX(1)"),o.a.createElement("div",{style:{position:"relative"}},o.a.createElement("video",{autoPlay:!0,playsInline:!0,muted:!0,ref:u}),o.a.createElement("canvas",{ref:s}))}),B=(n(207),function(){var t=s("/model_web");return o.a.createElement("div",{className:"fillPage"},o.a.createElement(w,{model:t,fit:"aspectFill",mirrored:!0}))}),F=document.getElementById("root");r.a.render(o.a.createElement(B,null),F)},83:function(t,e,n){t.exports=n(208)},91:function(t,e){},92:function(t,e){},93:function(t,e){},94:function(t,e){},95:function(t,e){},96:function(t,e){},99:function(t,e){}},[[83,1,2]]]);
//# sourceMappingURL=main.a020954e.chunk.js.map